<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Cost for a Website</title>

        <script type="application/javascript" src="../assets/js/jquery-1.11.1.min.js"></script>
        <script type="application/javascript" src="../assets/js/bootstrap.min.js"></script>

        <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
        <link href="test-style.css" rel="stylesheet">
    </head>

    <body>
        <div class="container">
            <div id="staticHead" class="page-header" style="text-align:center; display: none;">
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                    </div>
                </div>
                <h3>Current Estimate - <span class="total">&euro;0</span></h3>
            </div>

            <div class="row mt centered" style="margin-top: 225px;">	
                <h1>Cost for a Website</h1>
                <p>A quick and easy tool used to provide an estimate for your own website</p>
                <button id="begin" class="btn btn-primary btn-lg" type="button">Get started</button>            
            </div><!-- /row -->

            <div id="1" class="row mt centered question hidden">
                <div class="questionText">What's the size of the website?</div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="c.png" alt="" />
                    <p></p>
                    <p class="caption">Small</p>
                </div>
                <div data-amount="2500" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="c.png" alt="" />
                    <p></p>
                    <p class="caption">Medium</p>
                </div>
                <div data-amount="5000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="c.png" alt="" />
                    <p></p>
                    <p class="caption">Large</p>
                </div>
                <div data-amount="2500" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="c.png" alt="" />
                    <p></p>
                    <p class="caption">I'm not sure</p>
                </div>
            </div><!-- /row -->

            <div id="2" class="row mt centered question hidden">    
                <div class="questionText">What type of website is it?</div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Standard</p>
                </div>
                <div data-amount="2000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Responsive</p>
                </div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I'm not sure</p>
                </div>
            </div><!-- /row -->

            <div id="3" class="row mt centered question hidden">    
                <div class="questionText">Do you need a CMS?</div>
                <div data-amount="2500" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">Yes</p>
                </div>
                <div data-amount="0" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">No</p>
                </div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">I'm not sure</p>
                </div>
                <div class="col-lg-3">
                </div>
            </div><!-- /row -->

            <!--
<div id="3" class="row mt centered question hidden">    
<div class="questionText">Do you need a CMS?</div>
<div data-amount="1000" class="col-lg-3 multi-answer">
<img class="img-responsive center-block" src="g.png" alt="" />
<p></p>
<p class="caption">Yes</p>
</div>
<div data-amount="1000" class="col-lg-3 multi-answer">
<img class="img-responsive center-block" src="g.png" alt="" />
<p></p>
<p class="caption">No</p>
</div>
<div data-amount="1000" class="col-lg-3 multi-answer">
<img class="img-responsive center-block" src="g.png" alt="" />
<p></p>
<p class="caption">I'm not sure</p>
</div>
<div class="col-lg-3">
</div>
<button class="multiChoiceSubmit btn btn-default" type="button">Next</button> 
</div> 
-->

            <div id="4" class="row mt centered question hidden">    
                <div class="questionText">What about the website's content?</div>
                <div data-amount="0" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">I have all content already</p>
                </div>
                <div data-amount="0" class="col-lg-3 conditional-answer" data-next="5">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">I have some content already</p>
                </div>
                <div data-amount="0" class="col-lg-3 conditional-answer" data-next="5">
                    <img class="img-responsive center-block" src="g.png" alt="" />
                    <p></p>
                    <p class="caption">I have no content yet</p>
                </div>
            </div><!-- /row -->

            <div id="5" class="row mt centered branch-question hidden">   
                <div class="questionText">Do you need help with content?</div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Yes</p>
                </div>
                <div data-amount="0" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">No</p>
                </div>
            </div><!-- /row -->

            <div id="6" class="row mt centered question hidden">    
                <div class="questionText">What about the websites images?</div>
                <div data-amount="0" class="col-lg-3 answer" data-next="7">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I have all images already</p>
                </div>
                <div data-amount="0" class="col-lg-3 conditional-answer" data-next="7">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I have some images already</p>
                </div>
                <div data-amount="0" class="col-lg-3 conditional-answer" data-next="7">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I have no images yet</p>
                </div>
            </div>

            <div id="7" class="row mt centered branch-question hidden">    
                <div class="questionText">Do you need help with images?</div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Yes</p>
                </div>
                <div data-amount="0" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">No</p>
                </div>
            </div>

            <div id="8" class="row mt centered question hidden">    
                <div class="questionText">What's your timeframe?</div>
                <div data-amount="2000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I'm in a rush</p>
                </div>
                <div data-amount="1000" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I'm flexible</p>
                </div>
                <div data-amount="500" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">I have no deadlines</p>
                </div>
            </div>

            <div id="9" class="row mt centered question hidden">    
                <div class="questionText">What phase are you currently in?</div>
                <div data-amount="1500" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Just researching</p>
                </div>
                <div data-amount="800" class="col-lg-3 answer">
                    <img class="img-responsive center-block" src="f.png" alt="" />
                    <p></p>
                    <p class="caption">Looking to make a decision soon</p>
                </div>
            </div>

            <div id="enquiry" class="row mt centered hidden">

                <div class="col-xs-6">
                    <fieldset>

                        <legend>Summary</legend>
                        <ul id="summaryList" class="list-group">
<!--                            <li class="list-group-item">Free Domain Name Registration</li>-->
                        </ul>
                        
                        <div >
                            <b>Final estimate</b><p><span id="finalEstimate"></span></p>
                        </div>
                    </fieldset>
                </div>
                <div class="col-xs-6">
                    <!--
<form role="form" action="enquiry.php" method="POST">
<div class="form-group">
<label>First Name</label>
<input type="text" class="form-control" name="firstName">
</div>
<div class="form-group">
<label>Last Name</label>
<input type="text" class="form-control" name="lastName">
</div>
<div class="form-group">
<label>Email address</label>
<input type="email" class="form-control" name="email" required>
</div>
<button type="submit" class="btn btn-default">Submit Enquiry</button>
</form>
-->           
                    <form role="form" class="form-horizontal" action="enquiry.php" method="POST">
                        <fieldset>

                            <legend>Project Enquiry</legend>

                            <div class="form-group">
                                <label class="col-md-4 control-label" for="email">Email</label>  
                                <div class="col-md-5">
                                    <input id="email" name="email" type="text" placeholder="" class="form-control input-md" required="">

                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-4 control-label" for="firstName">First Name</label>  
                                <div class="col-md-5">
                                    <input id="firstName" name="firstName" type="text" placeholder="" class="form-control input-md">

                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-4 control-label" for="lastName">Last Name</label>  
                                <div class="col-md-5">
                                    <input id="lastName" name="lastName" type="text" placeholder="" class="form-control input-md">

                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-4 control-label" for="submitEnquiry"></label>
                                <div class="col-md-4">
                                    <button id="submitEnquiry" name="submitEnquiry" class="btn btn-primary">Submit Enquiry</button>
                                </div>
                            </div>

                        </fieldset>
                    </form>

                </div>

            </div>

        </div><!-- /container -->

    </body>
    <script type="text/javascript">
        var animationEnd = true;
        var total = 0;

        // Progress bar 
        var progress = 0;
        var progressInterval = 0;
        var numQuestions = $(".question").length;

        if(numQuestions != 0) {
            progressInterval = Math.round(100 / numQuestions); 
        }

        $(document).ready(function() {

            $('#begin').click(function() {
                $(this).parent().slideUp();

                $('#staticHead').show();

                $(this).parent().next('.question').removeClass('hidden');      
            });

            $('.answer').click(answerChosen);  

            $('.multi-answer').click(function(){
                $(this).toggleClass("multi-chosen");
            });

            $('.conditional-answer').click(function() {
                var id = $(this).data('next');

                $(this).parent('.question').slideUp();
                $('#' + id).removeClass('hidden');
            });

            $('.multiChoiceSubmit').click(function() {

                var amount = 0;
                $(this).siblings('.multi-chosen').each(function() {
                    amount += $(this).data('amount');
                });

                setEstimate(amount);

                progress += progressInterval;                       

                if(progress <= 100) { // replace with const or something
                    $('.progress-bar').css('width', progress+'%').attr('aria-valuenow', progress).html(progress+'%');
                } else {
                    alert("BUG");
                }

                moveToNext($(this));
            });

        });

        function answerChosen() {
            
            if(animationEnd) {
                
                rotationAnimation($(this));
                
                $(this).attr('data-chosen', 'true');
                
                animationEnd = false;

                $('.answer').off('click');

                updateEstimate($(this));

                moveToNext($(this));

                $('.answer').click(answerChosen); 
            }
        }
        
        

        function rotationAnimation(elem) {

            //                elem.css({
            //                    -moz-transform: 'rotateY(540deg)',
            //                    -webkit-transform: 'rotateY(540deg)',
            //                    -o-transform: 'rotateY(540deg)',
            //                    -ms-transform: 'rotateY(540deg)',
            //                    transform: 'rotateY(540deg)'
            //                });

            //                elem.css({
            //                    "-moz-transform": "rotateY(180deg)",
            //                    "-webkit-transform": "rotateY(180deg)",
            //                    "-o-transform": "rotateY(180deg)",
            //                    "-ms-transform": "rotateY(180deg)",
            //                    "transform": "rotateY(180deg)"
            //                });

            //elem.fadeOut();
            //if(!elem.hasClass('rotate')) {
            elem.addClass('rotate');
            //elem.removeClass('rotate');
            //}
        }


        function moveToNext(e) {

            if(e.parent('.question').length > 0) {
                var elem = e.parent('.question');
            } else if(e.parent('.branch-question').length > 0) {
                var elem = e.parent('.branch-question');
            }

            elem.slideUp('normal', function() {
                animationEnd = true;
            });

            // Reached end
            if(elem.nextAll('.question').length < 1) {
                $('#staticHead').slideUp();
                $('#enquiry').removeClass('hidden');
                
                $('#finalEstimate').html(prettyPrintMoney(total));
                //$('#summaryList').append("<li class='list-group-item'>" + "</li>")
                
                lol();
            }

            elem.nextAll('.question').first().removeClass('hidden');//'.question'? needed?
        }

        function updateEstimate(e) {
            var amount = 0;

            if(e.data('amount')) {   
                amount = e.data('amount');
            }

            setEstimate(amount);

            // Update progress bar
            progress += progressInterval;                       

            if(progress <= 100) { // replace with const or something
                $('.progress-bar').css('width', progress+'%').attr('aria-valuenow', progress).html(progress+'%');
            } else {
                alert("BUG");
            }
        }
        
        function lol() {
            var questions = [];
            
            $('[data-chosen]').each(function() {
                var q = $(this).siblings('.questionText').html();
                var text = $(this).children('.caption').html();
                
                $('#summaryList').append("<li class='list-group-item'><i>" + q + "</i> : " + text + "</li>");        
                
            });
        }

        function setEstimate(amount) {
            total += amount; 
            $('.total').html(prettyPrintMoney(total));
        }

        function prettyPrintMoney(s) {
            return "&euro;" + s.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    </script>
</html>
